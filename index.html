<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GENÃ‡ GROSS Â· Mobil Terminal</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1c2aae">
  <style>
    :root{--blue:#1c2aae;--orange:#f0552c;--bg:#fff;--card:#f6f8ff;--text:#102050;--muted:#667;--ok:#1fbf75;--warn:#ff5d5d}
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:var(--bg);color:var(--text)}
    header{padding:14px 10px;background:linear-gradient(90deg,var(--orange),var(--blue));color:#fff;text-align:center}
    header .brand{font-weight:800;letter-spacing:.3px}
    .wrap{max-width:980px;margin:auto;padding:10px}
    .card{margin:10px 0;padding:12px;background:var(--card);border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
    button{padding:9px 14px;margin:3px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
    .primary{background:var(--blue);color:#fff}
    .accent{background:var(--orange);color:#fff}
    .good{background:var(--ok);color:#fff}
    .warn{background:var(--warn);color:#fff}
    .row{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    label{font-size:13px}
    input[type="file"],input[type="text"],input[type="number"],input[type="tel"],select{border:1px solid #d6daf2;border-radius:8px;padding:8px}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border-bottom:1px solid #dbe1ff;padding:8px}
    th{background:#e9edff;color:#233}
    .right{text-align:right}
    .muted{color:var(--muted);font-size:12px}
    .chip{display:inline-block;background:#e8ecff;color:#334;padding:2px 8px;border-radius:999px;font-size:12px;margin-right:6px;border:1px solid #d6daf2}
    .videoBox{position:relative;border-radius:12px;overflow:hidden;background:#000}
    video{display:block;width:100%;max-height:320px}
    .roi{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none}
    .roi:after{content:"";width:68%;height:32%;border:2px solid rgba(255,255,255,.9);border-radius:10px;box-shadow:0 0 0 200vmax rgba(0,0,0,.35) inset}
    .qtybtn{padding:6px 10px;border:1px solid #d6daf2;background:#fff;border-radius:8px}
    .pname{font-weight:700;color:#0a7a2b}
    .pprice{font-weight:700;color:#a14900}
    .result{background:#fff;border:1px solid #e1e6ff;border-radius:12px;padding:10px;margin:8px 0}
    .result b{display:block;margin-bottom:4px}
  </style>
</head>
<body>
  <header><div class="brand">ðŸ“¦ GENÃ‡ GROSS</div></header>

  <div class="wrap">

    <!-- KAMERA -->
    <div class="card">
      <div class="row">
        <label>Kamera:</label>
        <select id="cameraSelect"></select>
        <button id="btnStart" class="primary">KamerayÄ± BaÅŸlat</button>
        <button id="btnStop">Durdur</button>
        <button id="btnScanOnce" class="accent" style="margin-left:auto">ðŸ‘‰ Tek Okut</button>
      </div>
      <div class="videoBox">
        <video id="video" playsinline autoplay muted></video>
        <div class="roi"></div>
      </div>
      <div class="status">
        <span id="scanStatus" class="chip">HazÄ±r</span>
        <span id="fps" class="chip">FPS: -</span>
      </div>
    </div>

    <!-- GÄ°RÄ°Åž + LÄ°STE -->
    <div class="card">
      <label>Barkod / Kod & Adet</label>
      <div class="row">
        <input id="barcode" type="tel" inputmode="numeric" pattern="[0-9]*" autocomplete="off"
               placeholder="Barkod veya Kod" style="flex:1;min-width:220px" />
        <button id="btnGo" class="accent">Tamam</button>
        <button id="btnClearField">Temizle</button>
      </div>

      <div class="row">
        <button id="btnMinus" class="qtybtn">âˆ’1</button>
        <input id="qty" type="number" value="1" min="1" step="1" style="width:90px;text-align:center" />
        <button id="btnPlus" class="qtybtn">+1</button>
        <button id="btnAdd" class="good">Ekle</button>
        <button id="btnUndo">Geri Al</button>
      </div>

      <div class="muted">ÃœrÃ¼n: <span id="productName" class="pname">â€”</span> Â· Fiyat: <span id="productPrice" class="pprice">â€”</span></div>

      <label>Dosya AdÄ±:</label>
      <input id="filename" placeholder="sayim" style="width:60%" />

      <div class="row" style="margin-top:8px">
        <button id="btnExport" class="primary">TXT Olarak DÄ±ÅŸa Aktar</button>
        <button id="btnPDF" class="accent">PDF Olarak DÄ±ÅŸa Aktar</button>
        <button id="btnClear" class="warn">Listeyi Temizle</button>
      </div>

      <table>
        <thead><tr><th>Kod/Barkod</th><th>Ä°sim</th><th class="right">Adet</th><th></th></tr></thead>
        <tbody id="tbody"></tbody>
      </table>
      Toplam satÄ±r: <span id="totalRows">0</span> Â· Toplam adet: <span id="totalQty">0</span>
    </div>

    <!-- ÃœRÃœN VERÄ°SÄ° -->
    <div class="card">
      <h3 style="margin:4px 0 8px 0">ÃœrÃ¼n Verisi YÃ¼kle</h3>
      <div class="muted">CSV/TXT (Ã¶r. <code>kod;isim;...;fiyat</code>) ya da <b>Genius 2 SQL (GNCPULUF)</b> veya JSON yÃ¼kleyebilirsin. YÃ¼klendikten sonra cihazda saklanÄ±r.</div>
      <div class="row">
        <input id="productFile" type="file" accept=".txt,.csv,.json,.gdf,.gtf,.gncpuluf,.dat" />
        <select id="encoding">
          <option value="windows-1254">TÃ¼rkÃ§e (Windows-1254)</option>
          <option value="utf-8">UTF-8</option>
        </select>
        <button id="btnClearMap" class="warn">ÃœrÃ¼n Verisini Temizle</button>
        <span class="chip" id="mapStat">0 Ã¼rÃ¼n yÃ¼klÃ¼</span>
      </div>
    </div>

    <!-- ARAMA -->
    <div class="card">
      <h3>ÃœrÃ¼n Arama (isimle)</h3>
      <input id="search" placeholder="Ã¶rn: onurlu, ekmek, kolonya..." />
      <div id="results"></div>
      <div class="muted">SonuÃ§lara dokununca barkodu kopyalar ve Ã¼st giriÅŸe doldurur.</div>
    </div>

    <audio id="beep" src="beep.ogg" preload="auto"></audio>
    <audio id="err"  src="error.ogg" preload="auto"></audio>
  </div>

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }
  </script>
</body>
</html>
