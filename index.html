<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GenÃ§ GROSS â€¢ Mobil Terminal</title>
  <meta name="theme-color" content="#0b1220"/>
  <link rel="manifest" href="manifest.json">
  <style>
    :root{
      --bg:#0b1220; --card:#16233f; --text:#fff; --muted:#9cb0d2;
      --blue:#1a54ff; --orange:#ff7a00; --ok:#17c964; --warn:#ff5d5d;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Segoe UI,Roboto;background:var(--bg);color:var(--text)}
    header{position:sticky;top:0;background:#0a1a5a;padding:10px 14px;z-index:10}
    header h1{margin:0;font-size:18px;letter-spacing:.2px}
    header small{color:#cfe1ff}
    .wrap{max-width:900px;margin:auto;padding:10px}
    .card{background:var(--card);border-radius:14px;padding:12px;margin:10px 0}
    .row{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    label{font-size:13px;color:#c6d6ff}
    select,input,button{border-radius:10px;border:1px solid #2a3b69;background:#0f1c35;color:#fff}
    input{padding:10px}
    button{padding:10px 14px;border:none;cursor:pointer}
    .primary{background:var(--blue)}
    .good{background:var(--ok);color:#042414}
    .warn{background:var(--warn);color:#2b0b0b}
    .orange{background:var(--orange)}
    .chip{display:inline-block;background:#0f1c35;border:1px solid #2a3b69;color:#a9bce8;
      border-radius:999px;padding:4px 10px;margin-right:6px;font-size:12px}
    video{width:100%;max-height:320px;background:#000;border-radius:12px;display:block}
    .videoBox{position:relative}
    .roi{position:absolute;inset:0;display:flex;justify-content:center;align-items:center;pointer-events:none}
    .roi:after{content:"";width:70%;height:32%;border:2px solid rgba(255,255,255,.85);border-radius:12px;
      box-shadow:0 0 0 200vmax rgba(0,0,0,.35) inset}
    table{width:100%;border-collapse:collapse;margin-top:8px}
    th,td{border-bottom:1px solid #293a67;padding:8px}
    th{color:#9cb0d2;text-align:left}
    .right{text-align:right}
    .muted{color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <header>
    <h1>GENÃ‡ GROSS â€¢ <small>Mobil Terminal</small></h1>
  </header>

  <div class="wrap">

    <!-- Kamera -->
    <div class="card">
      <div class="row">
        <label>Kamera:</label>
        <select id="cameraSelect"></select>
        <button id="btnStart" class="primary">KamerayÄ± BaÅŸlat</button>
        <button id="btnStop">Durdur</button>
        <button id="btnOneShot" class="orange">ðŸ‘‰ Tek Okut</button>
      </div>
      <div class="videoBox">
        <video id="video" playsinline autoplay muted></video>
        <div class="roi"></div>
      </div>
      <div style="margin-top:6px">
        <span id="scanStatus" class="chip">Durduruldu</span>
        <span id="tech" class="chip">Motor: -</span>
        <span id="fps" class="chip">FPS: -</span>
      </div>
      <div class="muted">Ä°pucu: Barkodu kutunun iÃ§inde, 15â€“25 cm mesafe, iyi Ä±ÅŸÄ±k.</div>
    </div>

    <!-- Barkod & adet -->
    <div class="card">
      <h3 style="margin:4px 0 10px">Barkod & Adet</h3>
      <div class="row">
        <input id="barcode" inputmode="numeric" pattern="[0-9]*" placeholder="Barkod" style="flex:1;min-width:220px">
        <button id="btnClearCode">Temizle</button>
        <button id="btnManualOk" class="orange">Tamam</button>
      </div>

      <div class="row">
        <button id="btnMinus">-1</button>
        <input id="qty" type="number" value="1" min="1" style="width:110px;text-align:center">
        <button id="btnPlus">+1</button>
        <button id="btnAdd" class="good">Ekle</button>
        <button id="btnUndo">Geri Al</button>
      </div>

      <div class="row">
        <div>ÃœrÃ¼n: <b id="pName" style="color:#ffb37a">â€”</b> Â· Fiyat: <b id="pPrice" style="color:#ffb37a">â€”</b></div>
      </div>

      <label>Dosya AdÄ±:</label>
      <input id="filename" placeholder="sayim" style="width:60%">

      <div class="row" style="margin-top:10px">
        <button id="btnExport" class="primary">TXT Olarak DÄ±ÅŸa Aktar</button>
        <button id="btnCSV">CSV Olarak DÄ±ÅŸa Aktar</button>
        <button id="btnClearList" class="warn">Listeyi Temizle</button>
      </div>

      <table>
        <thead><tr><th>Barkod</th><th>Ä°sim</th><th class="right">Adet</th><th></th></tr></thead>
        <tbody id="tbody"></tbody>
      </table>
      Toplam satÄ±r: <span id="totalRows">0</span> Â· Toplam adet: <span id="totalQty">0</span>
    </div>

    <!-- ÃœrÃ¼n verisi -->
    <div class="card">
      <h3 style="margin:4px 0 10px">ÃœrÃ¼n Verisi YÃ¼kle (opsiyonel)</h3>
      <div class="muted">GDF/TXT/CSV (ERP Ã§Ä±ktÄ±sÄ±). Format: <code>barkod;isim;fiyat</code> Â· Fiyat virgÃ¼llÃ¼ olabilir (Ã¶r: 11,90).</div>
      <div class="row" style="margin-top:8px">
        <input type="file" id="fileInput" accept=".csv,.txt,.gdf,.json">
        <button id="btnClearDB">ÃœrÃ¼n Verisini Temizle</button>
        <span class="chip" id="dbCount">0 Ã¼rÃ¼n yÃ¼klÃ¼</span>
      </div>
    </div>

    <audio id="beepOk" src="beep.ogg" preload="auto"></audio>
    <audio id="beepErr" src="notfound.ogg" preload="auto"></audio>
  </div>

  <script src="app.js"></script>
  <script>
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('sw.js').catch(()=>{});
    }
  </script>
</body>
</html>
