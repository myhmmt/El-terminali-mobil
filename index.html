<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GEN√á GROSS ‚Ä¢ Mobil Terminal</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#1C2AAE" />
  <style>
    :root{
      --blue:#1C2AAE;--orange:#F0552C;--bg:#fff;--card:#f6f8ff;--text:#142043;--muted:#6b7391;--ok:#16a34a;--warn:#ef4444;
      --priceRed:#e11d48; --titleNavy:#0b1d4b;
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:var(--bg);color:var(--text)}
    header{padding:12px 10px;background:linear-gradient(90deg,var(--orange),var(--blue));color:#fff}
    header .wrap{max-width:980px;margin:auto;display:flex;justify-content:center;align-items:center}
    header .ttl{font-weight:800;letter-spacing:.3px;text-align:center}
    .wrap{max-width:980px;margin:auto;padding:12px}
    .card{background:var(--card);padding:12px;border-radius:12px;margin:10px 0;border:1px solid #e5e9ff}
    button{padding:8px 12px;margin:2px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
    .primary{background:var(--blue);color:#fff}
    .accent{background:var(--orange);color:#fff}
    .good{background:var(--ok);color:#fff}
    .warn{background:var(--warn);color:#fff}
    .row{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    label{font-size:13px}
    input[type="file"],input[type="text"],input[type="number"],input[type="search"],select{border:1px solid #d6daf2;border-radius:8px;padding:8px}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border-bottom:1px solid #dbe1ff;padding:8px}
    th{background:#e9edff;color:#233}
    .right{text-align:right}
    .muted{color:var(--muted);font-size:12px}
    .chip{display:inline-block;background:#e8ecff;color:#334;padding:4px 8px;border-radius:999px;font-size:12px;margin-right:6px;border:1px solid #d6daf2}

    /* KAMERA */
    .videoBox{position:relative;border-radius:12px;overflow:hidden;background:#000;max-width:680px;margin-top:8px}
    video{width:100%;height:auto;display:block;max-height:45vh;object-fit:cover}
    .guide{position:absolute;inset:0;pointer-events:none;display:flex;align-items:center;justify-content:center}
    .guide::after{content:"";width:72%;height:36%;border:3px dashed rgba(255,255,255,.85);border-radius:12px;box-shadow:0 0 0 200vmax rgba(0,0,0,.35) inset}

    /* Adet butonlarƒ± kaldƒ±rƒ±ldƒ±ƒüƒ± i√ßin yok */

    /* √úr√ºn adƒ± ve fiyat g√∂r√ºn√ºm√º */
    .pname{
      font-weight:800;color:var(--titleNavy);font-size:18px;letter-spacing:.2px;line-height:1.2;text-transform:uppercase;
    }
    .pprice{
      font-weight:800;color:var(--priceRed);font-size:20px;line-height:1.2;
    }
    .productInfoBox{
      margin:10px 0 4px 0;background:#fff;border:1px solid #e5e7f4;border-radius:12px;padding:10px 12px;box-shadow:0 2px 8px rgba(16,32,80,.06);
    }

    .result{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border:1px solid #dbe1ff;border-radius:10px;background:#fff;margin:6px 0}
    .result small{color:#6b7391}

    /* ‚ÄúTek Okut‚Äù sabit FAB */
    #btnScanOnce{position:fixed;right:16px;bottom:16px;z-index:9999;border-radius:999px;padding:12px 16px;box-shadow:0 8px 24px rgba(0,0,0,.18)}

    /* Kamera se√ßici gizli */
    #cameraSelect{display:none}
  </style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="ttl">üì¶ GEN√á GROSS ‚Ä¢ Mobil Terminal</div>
  </div>
</header>

<div class="wrap">

  <!-- KAMERA -->
  <div class="card">
    <div class="row">
      <button id="btnStart" class="primary">Kamerayƒ± Ba≈ülat</button>
      <button id="btnStop">Durdur</button>
      <span class="chip" id="scanStatus">Hazƒ±r</span>
      <span class="chip" id="fps">FPS: -</span>
      <select id="cameraSelect"></select>
    </div>
    <div class="videoBox">
      <video id="video" playsinline autoplay muted></video>
      <div class="guide"></div>
    </div>
  </div>

  <!-- BARKOD / ADET -->
  <div class="card">
    <div class="row">
      <label>Barkod / Kod</label>
      <input id="barcode" inputmode="numeric" pattern="[0-9]*" placeholder="Barkod yaz / okut" style="flex:1;min-width:200px" />
      <button id="btnClearField">Temizle</button>
      <button id="btnSubmitCode" class="accent">Bilgiyi G√∂ster</button>
      <label>Adet</label>
      <input id="qty" type="number" value="1" min="1" style="width:110px" />
      <button id="btnAdd"   class="good">Ekle</button>
    </div>

    <!-- √úr√ºn adƒ± + fiyat, barkod ile adet arasƒ±nda kutuda -->
    <div id="productInfoBox" class="productInfoBox">
      <div id="productName"  class="pname">‚Äî</div>
      <div id="productPrice" class="pprice">‚Äî</div>
    </div>
  </div>

  <!-- Lƒ∞STE + ARAMA -->
  <div class="card">
    <div class="row">
      <input id="searchName" type="search" placeholder="ƒ∞simle ara..." style="flex:1;min-width:260px" />
    </div>
    <div id="searchList"></div>

    <table>
      <thead><tr><th>Barkod</th><th>ƒ∞sim</th><th class="right">Adet</th><th></th></tr></thead>
      <tbody id="tbody"></tbody>
    </table>
    Toplam satƒ±r: <span id="totalRows">0</span> ¬∑ Toplam adet: <span id="totalQty">0</span>
  </div>

  <!-- √úR√úN VERƒ∞Sƒ∞ -->
  <div class="card">
    <h3 style="margin:4px 0 8px 0">√úr√ºn Verisi Y√ºkle</h3>
    <div class="muted">TXT/CSV (√∂r. <code>kod;isim;‚Ä¶;fiyat</code>). Y√ºklendikten sonra veri cihazda saklanƒ±r.</div>
    <div class="row">
      <input id="productFile" type="file" accept=".txt,.csv,.json" />
      <span id="mapStat" class="chip">0 √ºr√ºn y√ºkl√º</span>
      <button id="btnClearMap" class="warn">Temizle</button>
    </div>

    <div class="row" style="margin-top:10px">
      <label>Dosya Adƒ±</label>
      <input id="filename" placeholder="sayim" style="width:60%" />
      <button id="btnExport" class="primary">TXT Olarak Dƒ±≈üa Aktar</button>
      <button id="btnPDF" class="accent">PDF Olarak Dƒ±≈üa Aktar</button>
      <button id="btnClear" class="warn">Listeyi Temizle</button>
    </div>
  </div>

  <audio id="beep"  src="beep.ogg"  preload="auto"></audio>
  <audio id="err"   src="error.ogg" preload="auto"></audio>
</div>

<!-- Sabit ‚ÄúTek Okut‚Äù -->
<button id="btnScanOnce" class="accent">üëâ Tek Okut</button>

<script src="app.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js').catch(()=>{});
  }
</script>
</body>
</html>
